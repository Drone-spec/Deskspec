/*! For license information please see recover.js.LICENSE.txt */
(()=>{"use strict";var e,t={905:(e,t,r)=>{var s=r(294),n=r(935),o=r(697),i=r.n(o);class a extends s.Component{constructor(e){super(e),this.createRefs()}componentDidMount(){this.loadIframe()}createRefs(){this.iframeRef=s.createRef()}loadIframe(){const e=`${this.props.browserExtensionUrl}webAccessibleResources/passbolt-iframe-recover.html?passbolt=passbolt-iframe-recover`;this.iframeRef.current.contentWindow.location=e}render(){return s.createElement("iframe",{id:"passbolt-iframe-recover",ref:this.iframeRef,className:"full-screen"})}}a.propTypes={browserExtensionUrl:i().string};const c=a;class l extends s.Component{componentDidMount(){this.removeSkeleton(),this.handleRemoveIframeRequested()}isPassboltApp(){const e=document.getRootNode().lastChild;return"HTML"===e?.tagName&&e.classList.contains("passbolt")}removeSkeleton(){const e=document.getElementById("temporary-skeleton");e&&e.remove()}handleRemoveIframeRequested(){this.props.port.on("passbolt.recover-bootstrap.remove-iframe",this.removeRecoverIframe.bind(this))}removeRecoverIframe(){const e=document.getElementById("passbolt-iframe-recover");e&&e.remove()}render(){return this.isPassboltApp()?s.createElement(s.Fragment,null,s.createElement(c,{browserExtensionUrl:this.props.browserExtensionUrl})):null}}l.propTypes={browserExtensionUrl:i().string,port:i().object};const d=l;var h=r(150),p=r.n(h);p().scripting||(p().scripting=new class{executeScript(e){e.func?this._insertJsFunc(e):this._insertJsFiles(e)}insertCSS(e){let t=null;const r=e.files;for(let s=r.length-1;s>=0;--s){const n={file:r[s],runAt:"document_end",frameId:e.target?.frameId};t=this._createCssCallback(e.target.tabId,n,t)}t&&t()}_createJsCallback(e,t,r){return()=>chrome.tabs.executeScript(e,t,r)}_createCssCallback(e,t,r){return()=>chrome.tabs.insertCSS(e,t,r)}_insertJsFiles(e){let t=null;const r=e.files;for(let s=r.length-1;s>=0;--s){const n={file:r[s],runAt:"document_end",frameId:e.target?.frameId};t=this._createJsCallback(e.target.tabId,n,t)}t&&t()}_insertJsFunc(e){const t=JSON.stringify(e.args),r=`;${e.func.name}.apply(window, ${t});`,s={code:e.func.toString()+r,runAt:"document_end",frameId:e.target?.frameId};this._createJsCallback(e.target.tabId,s,null)()}});p().storage.session||(p().storage.session=new class{constructor(){this._storedData={}}async get(e){const t=typeof e;if("string"!==t&&"undefined"!==t)throw new Error(`Expected keys type of "string" but received an unsopprted type: ${t}`);return e?this._storedData[e]?{[e]:this._storedData[e]}:{}:this._storedData}async set(e){if("object"!=typeof e)throw new Error('Expected keys type of "object" but received an unsopprted type: '+typeof e);for(const t in e)this._storedData[t]=JSON.parse(JSON.stringify(e[t]))}async remove(e){delete this._storedData[e]}async clear(){this._storedData={}}});const f=p();var m=r(586),u=r(187);r(889);!async function(){const e=new class{constructor(e){if(this._listeners={},this.lock=new class{constructor(){this._locked=!1,this._ee=new u.EventEmitter}acquire(){return new Promise((e=>{if(!this._locked)return this._locked=!0,e();const t=()=>{if(!this._locked)return this._locked=!0,this._ee.removeListener("release",t),e()};this._ee.on("release",t)}))}release(){this._locked=!1,setImmediate((()=>this._ee.emit("release")))}},void 0===e)throw Error("A port name is required.");if("string"!=typeof e)throw Error("The port name should be a valid string.");this._name=e}connect(){let e;const t=new Promise((t=>{e=t}));return this._port=f.runtime.connect({name:this._name}),this._connected=!0,this.initListener(),this.once("passbolt.port.ready",e),t}initListener(){this._port.onDisconnect.addListener((()=>{console.warn(`port disconnected from addon code: ${this._name}`),this._connected=!1})),this._port.onMessage.addListener((e=>{this._onMessage(e)}))}_onMessage(e){const t=JSON.parse(e),r=t[0];if(Array.isArray(this._listeners[r])){const e=this._listeners[r];for(let s=0;s<e.length;s++){const n=e[s],o=Array.prototype.slice.call(t,1);n.callback.apply(this,o),n.once&&(this._listeners[r].splice(s,1),0===this._listeners[r].length&&delete this._listeners[r],s--)}}}_addListener(e,t,r){Array.isArray(this._listeners[e])||(this._listeners[e]=[]),this._listeners[e].push({name:e,callback:t,once:r})}on(e,t){this._addListener(e,t,!1)}once(e,t){this._addListener(e,t,!0)}async emit(...e){const t=JSON.stringify(e);await this.connectIfDisconnected(),this._port.postMessage(t)}request(e,...t){const r=(0,m.Z)(),s=[e,r].concat(t);return new Promise(((e,t)=>{this.once(r,((r,...s)=>{"SUCCESS"===r?e.apply(null,s):"ERROR"===r&&t.apply(null,s)})),this.emit.apply(this,s)}))}async connectIfDisconnected(){await this.lock.acquire(),this._connected||await this.connect(),this.lock.release()}}(self.portname);await e.connect();const t=chrome.runtime.getURL("/"),r=document.createElement("div");document.body.appendChild(r),n.render(s.createElement(d,{port:e,browserExtensionUrl:t}),r)}()}},r={};function s(e){var n=r[e];if(void 0!==n)return n.exports;var o=r[e]={exports:{}};return t[e].call(o.exports,o,o.exports,s),o.exports}s.m=t,e=[],s.O=(t,r,n,o)=>{if(!r){var i=1/0;for(d=0;d<e.length;d++){for(var[r,n,o]=e[d],a=!0,c=0;c<r.length;c++)(!1&o||i>=o)&&Object.keys(s.O).every((e=>s.O[e](r[c])))?r.splice(c--,1):(a=!1,o<i&&(i=o));if(a){e.splice(d--,1);var l=n();void 0!==l&&(t=l)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[r,n,o]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.j=440,(()=>{var e={440:0};s.O.j=t=>0===e[t];var t=(t,r)=>{var n,o,[i,a,c]=r,l=0;if(i.some((t=>0!==e[t]))){for(n in a)s.o(a,n)&&(s.m[n]=a[n]);if(c)var d=c(s)}for(t&&t(r);l<i.length;l++)o=i[l],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(d)},r=self.contentScriptChunkLoadingGlobal=self.contentScriptChunkLoadingGlobal||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var n=s.O(void 0,[216],(()=>s(905)));n=s.O(n)})();