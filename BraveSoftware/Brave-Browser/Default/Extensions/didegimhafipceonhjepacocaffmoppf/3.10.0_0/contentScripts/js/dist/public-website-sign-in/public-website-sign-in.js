/*! For license information please see public-website-sign-in.js.LICENSE.txt */
(()=>{"use strict";var e,t={284:(e,t,s)=>{const n=new class{constructor(){this.bindCallbacks()}initialize(){this.addClassToDomElement(),this.handlePortDisconnectEvent(),this.handlePublicWebsiteClickEvent()}bindCallbacks(){this.handlePublicWebsiteClickEvent=this.handlePublicWebsiteClickEvent.bind(this),this.destroy=this.destroy.bind(this)}addClassToDomElement(){document.documentElement.classList.add("passbolt-extension")}async handlePublicWebsiteClickEvent(){document.documentElement.addEventListener("click",this.redirectToSignIn,!0)}redirectToSignIn(e){"extension-sign-in"===e.target.id&&port.request("passbolt.extension.sign-in-url")}destroy(){document.documentElement.removeEventListener("click",this.redirectToSignIn,!0),document.documentElement.classList.remove("passbolt-extension")}handlePortDisconnectEvent(){port._port.onDisconnect.addListener(this.destroy)}},r=async function(){n.initialize()};var i=s(150),o=s.n(i);o().scripting||(o().scripting=new class{executeScript(e){e.func?this._insertJsFunc(e):this._insertJsFiles(e)}insertCSS(e){let t=null;const s=e.files;for(let n=s.length-1;n>=0;--n){const r={file:s[n],runAt:"document_end",frameId:e.target?.frameId};t=this._createCssCallback(e.target.tabId,r,t)}t&&t()}_createJsCallback(e,t,s){return()=>chrome.tabs.executeScript(e,t,s)}_createCssCallback(e,t,s){return()=>chrome.tabs.insertCSS(e,t,s)}_insertJsFiles(e){let t=null;const s=e.files;for(let n=s.length-1;n>=0;--n){const r={file:s[n],runAt:"document_end",frameId:e.target?.frameId};t=this._createJsCallback(e.target.tabId,r,t)}t&&t()}_insertJsFunc(e){const t=JSON.stringify(e.args),s=`;${e.func.name}.apply(window, ${t});`,n={code:e.func.toString()+s,runAt:"document_end",frameId:e.target?.frameId};this._createJsCallback(e.target.tabId,n,null)()}});o().storage.session||(o().storage.session=new class{constructor(){this._storedData={}}async get(e){const t=typeof e;if("string"!==t&&"undefined"!==t)throw new Error(`Expected keys type of "string" but received an unsopprted type: ${t}`);return e?this._storedData[e]?{[e]:this._storedData[e]}:{}:this._storedData}async set(e){if("object"!=typeof e)throw new Error('Expected keys type of "object" but received an unsopprted type: '+typeof e);for(const t in e)this._storedData[t]=JSON.parse(JSON.stringify(e[t]))}async remove(e){delete this._storedData[e]}async clear(){this._storedData={}}});const a=o();var c=s(586),l=s(187);s(889);!async function(){self.port=new class{constructor(e){if(this._listeners={},this.lock=new class{constructor(){this._locked=!1,this._ee=new l.EventEmitter}acquire(){return new Promise((e=>{if(!this._locked)return this._locked=!0,e();const t=()=>{if(!this._locked)return this._locked=!0,this._ee.removeListener("release",t),e()};this._ee.on("release",t)}))}release(){this._locked=!1,setImmediate((()=>this._ee.emit("release")))}},void 0===e)throw Error("A port name is required.");if("string"!=typeof e)throw Error("The port name should be a valid string.");this._name=e}connect(){let e;const t=new Promise((t=>{e=t}));return this._port=a.runtime.connect({name:this._name}),this._connected=!0,this.initListener(),this.once("passbolt.port.ready",e),t}initListener(){this._port.onDisconnect.addListener((()=>{console.warn(`port disconnected from addon code: ${this._name}`),this._connected=!1})),this._port.onMessage.addListener((e=>{this._onMessage(e)}))}_onMessage(e){const t=JSON.parse(e),s=t[0];if(Array.isArray(this._listeners[s])){const e=this._listeners[s];for(let n=0;n<e.length;n++){const r=e[n],i=Array.prototype.slice.call(t,1);r.callback.apply(this,i),r.once&&(this._listeners[s].splice(n,1),0===this._listeners[s].length&&delete this._listeners[s],n--)}}}_addListener(e,t,s){Array.isArray(this._listeners[e])||(this._listeners[e]=[]),this._listeners[e].push({name:e,callback:t,once:s})}on(e,t){this._addListener(e,t,!1)}once(e,t){this._addListener(e,t,!0)}async emit(...e){const t=JSON.stringify(e);await this.connectIfDisconnected(),this._port.postMessage(t)}request(e,...t){const s=(0,c.Z)(),n=[e,s].concat(t);return new Promise(((e,t)=>{this.once(s,((s,...n)=>{"SUCCESS"===s?e.apply(null,n):"ERROR"===s&&t.apply(null,n)})),this.emit.apply(this,n)}))}async connectIfDisconnected(){await this.lock.acquire(),this._connected||await this.connect(),this.lock.release()}}(self.portname),await self.port.connect(),r()}()}},s={};function n(e){var r=s[e];if(void 0!==r)return r.exports;var i=s[e]={exports:{}};return t[e].call(i.exports,i,i.exports,n),i.exports}n.m=t,e=[],n.O=(t,s,r,i)=>{if(!s){var o=1/0;for(d=0;d<e.length;d++){for(var[s,r,i]=e[d],a=!0,c=0;c<s.length;c++)(!1&i||o>=i)&&Object.keys(n.O).every((e=>n.O[e](s[c])))?s.splice(c--,1):(a=!1,i<o&&(o=i));if(a){e.splice(d--,1);var l=r();void 0!==l&&(t=l)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[s,r,i]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={306:0};n.O.j=t=>0===e[t];var t=(t,s)=>{var r,i,[o,a,c]=s,l=0;if(o.some((t=>0!==e[t]))){for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(c)var d=c(n)}for(t&&t(s);l<o.length;l++)i=o[l],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(d)},s=self.contentScriptBrowserIntegrationChunkLoadingGlobal=self.contentScriptBrowserIntegrationChunkLoadingGlobal||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var r=n.O(void 0,[216],(()=>n(284)));r=n.O(r)})();